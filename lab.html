<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quant Lab - OpenQuant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0b0c15; color: #e2e8f0; }
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        const Icons = {
            Code: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>,
            Bot: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="10" rx="2"/><circle cx="12" cy="5" r="2"/><path d="M12 7v4"/><line x1="8" y1="16" x2="8" y2="16"/><line x1="16" y1="16" x2="16" y2="16"/></svg>,
            Play: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3v3m6.366-.366-2.12 2.12M21 12h-3m.366 6.366-2.12-2.12M12 21v-3m-6.366.366 2.12-2.12M3 12h3m-.366-6.366 2.12 2.12"/></svg>,
            FileText: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>,
            Folder: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>,
            Send: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            Info: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            Lightbulb: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"/></svg>,
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>,
        };
        const Icon = ({ name, size = 16, className = "" }) => {
            const IconComp = Icons[name];
            return IconComp ? <span className={`inline-block ${className}`} style={{width: size, height: size}}><IconComp /></span> : null;
        };

        const Navbar = () => (
            <nav className="fixed top-0 w-full z-50 bg-[#0b0c15]/90 backdrop-blur-md border-b border-gray-800">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="flex items-center justify-between h-16">
                        <a href="index.html" className="flex items-center gap-2 cursor-pointer">
                            <div className="w-8 h-8 bg-gradient-to-br from-green-400 to-blue-600 rounded-lg flex items-center justify-center shadow-lg shadow-green-500/20">
                                <span className="font-bold text-white text-lg">O</span>
                            </div>
                            <span className="font-bold text-xl tracking-tight text-white">OpenQuant</span>
                        </a>
                        <div className="hidden md:block">
                            <div className="ml-10 flex items-center gap-1 text-sm font-medium">
                                <a href="index.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">é¦–é¡µ</a>
                                <a href="dashboard.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">æ§åˆ¶å°</a>
                                <a href="lab.html" className="whitespace-nowrap text-green-400 px-3 py-2 rounded-md transition-colors border-b-2 border-green-400">é‡åŒ–å®éªŒå®¤</a>
                                <a href="marketplace.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">ç­–ç•¥å¹¿åœº</a>
                                <a href="data-center.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">æ•°æ®ä¸­å¿ƒ</a>
                                <a href="academy.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">å­¦é™¢</a>
                                <a href="pricing.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">ä»·æ ¼</a>
                                <a href="solutions.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">è§£å†³æ–¹æ¡ˆ</a>
                                <a href="community.html" className="whitespace-nowrap text-gray-300 hover:text-green-400 px-3 py-2 rounded-md transition-colors">ç¤¾åŒº</a>
                            </div>
                        </div>
                        <div className="flex items-center gap-4">
                            <div className="hidden md:flex items-center gap-2 text-xs text-gray-400 bg-gray-900 px-3 py-1 rounded-full border border-gray-800">
                                <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                                Co-location Active
                            </div>
                            <button className="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors shadow-lg shadow-green-900/20">
                                ç™»å½• / æ³¨å†Œ
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        );

        const Lab = () => {
            const [showStartModal, setShowStartModal] = useState(true);
            const [showAIPanel, setShowAIPanel] = useState(false);
            const [showTemplates, setShowTemplates] = useState(false);
            const [beginnerMode, setBeginnerMode] = useState(false);
            const [aiInput, setAiInput] = useState('');
            const [aiMessages, setAiMessages] = useState([
                {role: 'assistant', content: 'ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯ AI Copilotï¼Œå¯ä»¥å¸®ä½ ç”Ÿæˆç­–ç•¥ä»£ç ã€‚è¯•è¯•æè¿°ä½ çš„ç­–ç•¥æƒ³æ³•ï¼Œæ¯”å¦‚ï¼š"å½“BTCè·Œç ´20æ—¥å‡çº¿ä¸”RSIå°äº30æ—¶ä¹°å…¥"'}
            ]);
            
            const [code, setCode] = useState(`import openquant as oq\n\n# ç­–ç•¥å…¥å£ï¼šRust å¼•æ“å›è°ƒ\n@oq.rust_accelerate\ndef on_tick(context, tick):\n    # ç®€å•çš„åŒå‡çº¿ç­–ç•¥\n    ma_fast = oq.sma(tick.symbol, 5)\n    ma_slow = oq.sma(tick.symbol, 20)\n    \n    if ma_fast > ma_slow and context.pos == 0:\n        # æé€Ÿä¸‹å•ï¼ˆå¾®ç§’çº§ï¼‰\n        oq.order_target_percent(tick.symbol, 1.0)\n        context.log(f"Long Signal: {tick.price}")\n        \n    elif ma_fast < ma_slow and context.pos > 0:\n        oq.order_target_percent(tick.symbol, 0)\n        context.log(f"Close Signal: {tick.price}")`);

            const templates = [
                {
                    name: "åŒå‡çº¿ç­–ç•¥",
                    desc: "ç»å…¸è¶‹åŠ¿è·Ÿè¸ªç­–ç•¥ï¼Œé€‚åˆæ–°æ‰‹",
                    difficulty: "ç®€å•",
                    code: `import openquant as oq\n\n@oq.rust_accelerate\ndef on_tick(context, tick):\n    ma_fast = oq.sma(tick.symbol, 5)\n    ma_slow = oq.sma(tick.symbol, 20)\n    \n    if ma_fast > ma_slow and context.pos == 0:\n        oq.order_target_percent(tick.symbol, 1.0)\n    elif ma_fast < ma_slow and context.pos > 0:\n        oq.order_target_percent(tick.symbol, 0)`
                },
                {
                    name: "ç½‘æ ¼äº¤æ˜“",
                    desc: "éœ‡è¡å¸‚åœºåˆ©å™¨ï¼Œè‡ªåŠ¨é«˜æŠ›ä½å¸",
                    difficulty: "ä¸­ç­‰",
                    code: `import openquant as oq\n\n@oq.rust_accelerate\ndef on_tick(context, tick):\n    # ç½‘æ ¼å‚æ•°\n    grid_size = 0.01  # 1%ç½‘æ ¼\n    if tick.price < context.last_buy * (1 - grid_size):\n        oq.buy(tick.symbol, 0.1)\n        context.last_buy = tick.price\n    elif tick.price > context.last_sell * (1 + grid_size):\n        oq.sell(tick.symbol, 0.1)\n        context.last_sell = tick.price`
                },
                {
                    name: "RSI è¶…ä¹°è¶…å–",
                    desc: "åŸºäºRSIæŒ‡æ ‡çš„åè½¬ç­–ç•¥",
                    difficulty: "ç®€å•",
                    code: `import openquant as oq\n\n@oq.rust_accelerate\ndef on_tick(context, tick):\n    rsi = oq.rsi(tick.symbol, 14)\n    \n    if rsi < 30 and context.pos == 0:\n        # RSIè¶…å–ï¼Œä¹°å…¥\n        oq.buy_twap(tick.symbol, 1.0, duration=60)\n    elif rsi > 70 and context.pos > 0:\n        # RSIè¶…ä¹°ï¼Œå–å‡º\n        oq.sell_twap(tick.symbol, context.pos, duration=60)`
                },
                {
                    name: "MACD é‡‘å‰æ­»å‰",
                    desc: "ç»å…¸æŠ€æœ¯æŒ‡æ ‡ç­–ç•¥",
                    difficulty: "ä¸­ç­‰",
                    code: `import openquant as oq\n\n@oq.rust_accelerate\ndef on_tick(context, tick):\n    macd, signal = oq.macd(tick.symbol)\n    \n    if macd > signal and context.pos == 0:\n        # é‡‘å‰ä¹°å…¥\n        oq.order_target_percent(tick.symbol, 1.0)\n    elif macd < signal and context.pos > 0:\n        # æ­»å‰å–å‡º\n        oq.order_target_percent(tick.symbol, 0)`
                }
            ];

            const handleSendAI = () => {
                if (!aiInput.trim()) return;
                setAiMessages([...aiMessages, 
                    {role: 'user', content: aiInput},
                    {role: 'assistant', content: 'æ­£åœ¨ä¸ºä½ ç”Ÿæˆç­–ç•¥ä»£ç ...ï¼ˆæ¼”ç¤ºç‰ˆæœ¬ï¼Œå®é™…ä¼šè°ƒç”¨AIç”Ÿæˆï¼‰'}
                ]);
                setAiInput('');
            };

            const loadTemplate = (template) => {
                setCode(template.code);
                setShowTemplates(false);
            };
            
            return (
                <div>
                    {/* å¯åŠ¨æ¨¡æ€æ¡† */}
                    {showStartModal && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm">
                            <div className="bg-[#13151f] border border-gray-800 rounded-2xl p-8 max-w-4xl w-full mx-4 relative">
                                <button onClick={() => setShowStartModal(false)} className="absolute top-4 right-4 text-gray-500 hover:text-white">
                                    <Icon name="X" size={20} />
                                </button>
                                <h2 className="text-3xl font-bold text-white mb-4 text-center">æ¬¢è¿æ¥åˆ°é‡åŒ–å®éªŒå®¤</h2>
                                <p className="text-gray-400 text-center mb-8">é€‰æ‹©ä½ çš„å¼€å‘æ–¹å¼å¼€å§‹</p>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <div onClick={() => {setShowStartModal(false); setShowAIPanel(true);}} 
                                         className="bg-[#0b0c15] border border-gray-800 hover:border-blue-500 rounded-xl p-6 cursor-pointer transition-all group">
                                        <div className="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Icon name="Sparkles" size={24} className="text-blue-400" />
                                        </div>
                                        <h3 className="text-white font-bold mb-2">ğŸ¤– AI ç”Ÿæˆ</h3>
                                        <p className="text-gray-500 text-sm">ç”¨è‡ªç„¶è¯­è¨€æè¿°ç­–ç•¥ï¼ŒAIå¸®ä½ å†™ä»£ç </p>
                                        <div className="mt-4 text-xs text-blue-400">æ¨èæ–°æ‰‹ â†’</div>
                                    </div>

                                    <div onClick={() => {setShowStartModal(false); setShowTemplates(true);}} 
                                         className="bg-[#0b0c15] border border-gray-800 hover:border-green-500 rounded-xl p-6 cursor-pointer transition-all group">
                                        <div className="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Icon name="FileText" size={24} className="text-green-400" />
                                        </div>
                                        <h3 className="text-white font-bold mb-2">ğŸ“„ ä»æ¨¡æ¿å¼€å§‹</h3>
                                        <p className="text-gray-500 text-sm">é€‰æ‹©ç»å…¸ç­–ç•¥æ¨¡æ¿ï¼Œå¿«é€Ÿä¸Šæ‰‹</p>
                                        <div className="mt-4 text-xs text-green-400">æœ€å¿«é€Ÿ â†’</div>
                                    </div>

                                    <div onClick={() => {setShowStartModal(false);}} 
                                         className="bg-[#0b0c15] border border-gray-800 hover:border-purple-500 rounded-xl p-6 cursor-pointer transition-all group">
                                        <div className="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Icon name="Code" size={24} className="text-purple-400" />
                                        </div>
                                        <h3 className="text-white font-bold mb-2">ğŸ’» ç©ºç™½é¡¹ç›®</h3>
                                        <p className="text-gray-500 text-sm">ä»å¤´å¼€å§‹ç¼–å†™ä½ çš„ç­–ç•¥</p>
                                        <div className="mt-4 text-xs text-purple-400">å®Œå…¨è‡ªç”± â†’</div>
                                    </div>

                                    <div onClick={() => alert('TradingView å¯¼å…¥åŠŸèƒ½å³å°†ä¸Šçº¿')} 
                                         className="bg-[#0b0c15] border border-gray-800 hover:border-orange-500 rounded-xl p-6 cursor-pointer transition-all group">
                                        <div className="w-12 h-12 bg-orange-500/20 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                                            <Icon name="Download" size={24} className="text-orange-400" />
                                        </div>
                                        <h3 className="text-white font-bold mb-2">ğŸ“¥ å¯¼å…¥ TradingView</h3>
                                        <p className="text-gray-500 text-sm">å¯¼å…¥Pineè„šæœ¬è‡ªåŠ¨è½¬æ¢</p>
                                        <div className="mt-4 text-xs text-gray-500">å³å°†ä¸Šçº¿</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* æ¨¡æ¿é€‰æ‹©æ¨¡æ€æ¡† */}
                    {showTemplates && (
                        <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm">
                            <div className="bg-[#13151f] border border-gray-800 rounded-2xl p-8 max-w-5xl w-full mx-4 relative max-h-[80vh] overflow-y-auto">
                                <button onClick={() => setShowTemplates(false)} className="absolute top-4 right-4 text-gray-500 hover:text-white">
                                    <Icon name="X" size={20} />
                                </button>
                                <h2 className="text-2xl font-bold text-white mb-6">é€‰æ‹©ç­–ç•¥æ¨¡æ¿</h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {templates.map((template, i) => (
                                        <div key={i} onClick={() => loadTemplate(template)}
                                             className="bg-[#0b0c15] border border-gray-800 hover:border-green-500 rounded-xl p-6 cursor-pointer transition-all group">
                                            <div className="flex items-start justify-between mb-3">
                                                <div>
                                                    <h3 className="text-white font-bold text-lg group-hover:text-green-400 transition-colors">{template.name}</h3>
                                                    <p className="text-gray-500 text-sm mt-1">{template.desc}</p>
                                                </div>
                                                <span className={`text-xs px-2 py-1 rounded ${
                                                    template.difficulty === 'ç®€å•' ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'
                                                }`}>{template.difficulty}</span>
                                            </div>
                                            <div className="text-xs text-gray-600 font-mono bg-[#0d0f1a] p-3 rounded overflow-hidden">
                                                {template.code.split('\n').slice(0, 3).join('\n')}...
                                            </div>
                                            <div className="mt-3 text-sm text-green-400">ç‚¹å‡»ä½¿ç”¨ â†’</div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="pt-16 h-screen flex flex-col bg-[#0b0c15] animate-fade-in overflow-hidden">
                        {/* Toolbar */}
                        <div className="h-14 border-b border-gray-800 bg-[#13151f] px-4 flex items-center justify-between shrink-0">
                            <div className="flex items-center gap-4">
                                <div className="flex items-center gap-2 text-white font-semibold">
                                    <Icon name="Code" size={18} className="text-blue-400" />
                                    <span>Quant Lab</span>
                                </div>
                                <div className="h-6 w-px bg-gray-700"></div>
                                <div className="flex items-center gap-2 text-sm text-gray-400">
                                    <span>strategy_v1.py</span>
                                    <span className="text-xs bg-gray-700 px-1.5 rounded">Unsaved</span>
                                </div>
                            </div>
                            <div className="flex items-center gap-3">
                                <label className="flex items-center gap-2 text-sm text-gray-400 cursor-pointer">
                                    <input type="checkbox" checked={beginnerMode} onChange={(e) => setBeginnerMode(e.target.checked)} className="rounded" />
                                    <Icon name="Lightbulb" size={14} />
                                    <span>æ–°æ‰‹æ¨¡å¼</span>
                                </label>
                                <button onClick={() => setShowTemplates(true)} className="flex items-center gap-2 bg-gray-800 hover:bg-gray-700 text-white px-3 py-1.5 rounded text-sm transition-colors border border-gray-700">
                                    <Icon name="Folder" size={14} /> æ¨¡æ¿åº“
                                </button>
                                <button onClick={() => setShowAIPanel(!showAIPanel)} className="flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-3 py-1.5 rounded text-sm transition-colors">
                                    <Icon name="Sparkles" size={14} /> AI åŠ©æ‰‹
                                </button>
                                <button className="flex items-center gap-2 bg-green-600 hover:bg-green-500 text-white px-4 py-1.5 rounded text-sm font-medium transition-colors shadow-lg shadow-green-900/20">
                                    <Icon name="Play" size={14} /> è¿è¡Œå›æµ‹
                                </button>
                            </div>
                        </div>

                        <div className="flex-grow flex overflow-hidden">
                            {/* AI Copilot Panel */}
                            {showAIPanel && (
                                <div className="w-80 bg-[#0b0c15] border-r border-gray-800 flex flex-col">
                                    <div className="p-4 border-b border-gray-800 flex items-center justify-between">
                                        <div className="flex items-center gap-2">
                                            <Icon name="Sparkles" size={16} className="text-blue-400" />
                                            <span className="text-white font-semibold">AI Copilot</span>
                                        </div>
                                        <button onClick={() => setShowAIPanel(false)} className="text-gray-500 hover:text-white">
                                            <Icon name="X" size={16} />
                                        </button>
                                    </div>
                                    
                                    <div className="flex-grow overflow-y-auto p-4 space-y-4">
                                        {aiMessages.map((msg, i) => (
                                            <div key={i} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                <div className={`max-w-[80%] rounded-lg p-3 text-sm ${
                                                    msg.role === 'user' 
                                                        ? 'bg-blue-600 text-white' 
                                                        : 'bg-[#161822] border border-gray-800 text-gray-300'
                                                }`}>
                                                    {msg.content}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    
                                    <div className="p-4 border-t border-gray-800">
                                        <div className="bg-[#161822] border border-gray-800 rounded-lg p-2 mb-2">
                                            <div className="text-xs text-gray-500 mb-2 flex items-center gap-1">
                                                <Icon name="Info" size={12} />
                                                <span>ç¤ºä¾‹æç¤ºï¼š</span>
                                            </div>
                                            <div className="space-y-1 text-xs">
                                                <div onClick={() => setAiInput("å½“BTCè·Œç ´20æ—¥å‡çº¿ä¸”RSIå°äº30æ—¶ä¹°å…¥")} className="text-blue-400 hover:text-blue-300 cursor-pointer">â€¢ å½“BTCè·Œç ´20æ—¥å‡çº¿ä¸”RSIå°äº30æ—¶ä¹°å…¥</div>
                                                <div onClick={() => setAiInput("åˆ›å»ºä¸€ä¸ªç½‘æ ¼äº¤æ˜“ç­–ç•¥ï¼Œç½‘æ ¼é—´è·1%")} className="text-blue-400 hover:text-blue-300 cursor-pointer">â€¢ åˆ›å»ºä¸€ä¸ªç½‘æ ¼äº¤æ˜“ç­–ç•¥</div>
                                            </div>
                                        </div>
                                        <div className="flex gap-2">
                                            <input 
                                                type="text" 
                                                value={aiInput}
                                                onChange={(e) => setAiInput(e.target.value)}
                                                onKeyPress={(e) => e.key === 'Enter' && handleSendAI()}
                                                placeholder="æè¿°ä½ çš„ç­–ç•¥æƒ³æ³•..."
                                                className="flex-grow bg-[#161822] border border-gray-800 text-white text-sm rounded px-3 py-2 outline-none focus:border-blue-500"
                                            />
                                            <button onClick={handleSendAI} className="bg-blue-600 hover:bg-blue-500 text-white p-2 rounded">
                                                <Icon name="Send" size={16} />
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Sidebar */}
                            <div className="w-64 bg-[#0b0c15] border-r border-gray-800 hidden md:flex flex-col">
                                <div className="p-4 border-b border-gray-800 text-gray-400 text-xs font-bold uppercase tracking-wider">File Explorer</div>
                                <div className="p-2 space-y-1">
                                    <div className="flex items-center gap-2 text-green-400 bg-green-500/10 px-3 py-2 rounded cursor-pointer"><span className="text-xs">PY</span> strategy_v1.py</div>
                                    <div className="flex items-center gap-2 text-gray-400 hover:bg-gray-800/50 px-3 py-2 rounded cursor-pointer transition-colors"><span className="text-xs">JSON</span> config.json</div>
                                    <div className="flex items-center gap-2 text-gray-400 hover:bg-gray-800/50 px-3 py-2 rounded cursor-pointer transition-colors"><span className="text-xs">LOG</span> backtest.log</div>
                                </div>
                            </div>

                            {/* Editor */}
                            <div className="flex-grow bg-[#0b0c15] flex flex-col">
                                {beginnerMode && (
                                    <div className="bg-blue-500/10 border-b border-blue-500/30 px-4 py-2 flex items-center gap-2 text-sm text-blue-400">
                                        <Icon name="BookOpen" size={14} />
                                        <span>æ–°æ‰‹æ¨¡å¼å·²å¼€å¯ - ä»£ç å°†æ˜¾ç¤ºè¯¦ç»†æ³¨é‡Šå’Œè¯´æ˜</span>
                                    </div>
                                )}
                                <div className="flex-grow relative font-mono text-sm flex">
                                    <div className="w-12 bg-[#0b0c15] border-r border-gray-800 text-gray-600 text-right pr-3 pt-4 select-none leading-6">
                                        {code.split('\n').map((_, i) => <div key={i}>{i+1}</div>)}
                                    </div>
                                    <textarea 
                                        value={code} 
                                        onChange={(e) => setCode(e.target.value)}
                                        className="flex-grow bg-[#0b0c15] text-gray-300 p-4 outline-none resize-none leading-6"
                                        spellCheck="false"
                                    ></textarea>
                                </div>
                                
                                {/* Terminal / Logs */}
                                <div className="h-48 border-t border-gray-800 bg-[#13151f] p-4 font-mono text-xs overflow-y-auto">
                                    <div className="flex items-center gap-2 text-gray-500 mb-2 pb-2 border-b border-gray-800">
                                        <span className="text-white border-b-2 border-green-400 pb-2 -mb-2.5">Output</span>
                                        <span className="hover:text-white cursor-pointer">Logs</span>
                                        <span className="hover:text-white cursor-pointer">Errors</span>
                                    </div>
                                    <div className="space-y-1">
                                        <div className="text-green-500/80">[System] Rust Engine Initialized (v2.4.0)</div>
                                        <div className="text-gray-400">[Info] Loaded historic data: BTC-USDT (2024-01-01 ~ 2024-06-01)</div>
                                        <div className="text-blue-400">[Backtest] Running... Speed: 150,000 ticks/sec</div>
                                        <div className="text-gray-400">...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<div><Navbar /><Lab /></div>);
    </script>
</body>
</html>



